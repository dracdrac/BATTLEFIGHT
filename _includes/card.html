{% if include.blank %}

{% assign edition = "" %}
{% assign version = "" %}
{% assign number = "" %}
{% assign treatment = ""  %}
{% assign title = "" %}
{% assign type = "" %}
{% assign illu_src = "" %}
{% assign steps_classes = "" %}

{% else %}

{% assign edition = include.e | default: site.default_edition %}
{% assign edition_obj = site.data.editions | where: 'id', edition | first %}

{% assign version = include.v | default: edition_obj.current-version %}
{% assign version_obj = edition_obj.versions | where: 'id', version | first %}

{% assign number = include.n %}
{% assign card = site.data[version_obj.cards] | where: 'ID', number | first %}

{% assign treatment = include.t | default : site.default_treatment  %}

{% assign year = version_obj.year  %}

{% assign title = card.TITLE | strip %}
{% assign type = card.TYPE | strip %}
{% assign illu_src = version_obj.illu-dir | append: number | append: '.jpg' %}
{% assign steps_classes = card.STEPS | strip %}

{% endif %}

<div class="card"
  id="{{edition}}-{{number}}"
  data-title="{{title}}"
  data-type="{{type}}"
  data-edition="{{edition}}"
  data-number="{{number}}"
  data-version="{{version}}"
  data-treatment="{{treatment}}"
  >
  <div class=content>
    <div class="header">
      <div class="title">{{title}}</div>
      <div class="types type">{{type}}</div>
    </div>
    <div class=illu><img src="{{illu_src}}"/></div>
    <div class="steps">
      {% assign steps_size_minus = steps_classes.size | minus: 1 %}
      {% for i in (0..steps_size_minus) %}
      {% assign step_class = steps_classes | slice: i %}
      {% assign step_text_column = i | plus: 1 | prepend: 'STEP' %}
      {% assign step_text = card[step_text_column] %}
      {% include step.html class=step_class text=step_text %}
      {% endfor %}
  </div>
    <div class="footer">
      <div class="id"><span class="edition">{{edition}}</span>-<span class="number">{{number}}</span> <span class="treatment">{{treatment}}</span> <span class="version"><img title="{{version}}" src="{{version_obj.icon}}"/></span></div>
      <div class="copyright">BattleFight <span class="year">{{year}}</span></div>
    </div>
  </div>
</div>
